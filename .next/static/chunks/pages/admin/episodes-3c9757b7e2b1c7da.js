(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{1373:function(e,i,a){"use strict";a.d(i,{Z:function(){return c}});var t=a(7294);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,i,a)=>a?a.toUpperCase():i.toLowerCase()),s=e=>{let i=r(e);return i.charAt(0).toUpperCase()+i.slice(1)},n=(...e)=>e.filter((e,i,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===i).join(" ").trim(),l=e=>{for(let i in e)if(i.startsWith("aria-")||"role"===i||"title"===i)return!0};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,t.forwardRef)(({color:e="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:r="",children:s,iconNode:p,...c},f)=>(0,t.createElement)("svg",{ref:f,...d,width:i,height:i,stroke:e,strokeWidth:o?24*Number(a)/Number(i):a,className:n("lucide",r),...!s&&!l(c)&&{"aria-hidden":"true"},...c},[...p.map(([e,i])=>(0,t.createElement)(e,i)),...Array.isArray(s)?s:[s]])),c=(e,i)=>{let a=(0,t.forwardRef)(({className:a,...r},l)=>(0,t.createElement)(p,{ref:l,iconNode:i,className:n(`lucide-${o(s(e))}`,`lucide-${e}`,a),...r}));return a.displayName=s(e),a}},3219:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8419:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]])},332:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},9482:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},1012:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7705:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},3718:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},8142:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},1352:function(e,i,a){"use strict";a.d(i,{Z:function(){return t}});let t=(0,a(1373).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6328:function(e,i,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/episodes",function(){return a(867)}])},867:function(e,i,a){"use strict";a.r(i),a.d(i,{default:function(){return g}});var t=a(5893),o=a(2235),r=a.n(o),s=a(7294),n=a(3219),l=a(1012),d=a(332),p=a(9482),c=a(7705),f=a(3718),m=a(1352),x=a(8419),b=a(8142);let u="https://itxndrvoolbvzdseuljx.supabase.co",h="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0eG5kcnZvb2xidnpkc2V1bGp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMzUyNjYsImV4cCI6MjA3MzcxMTI2Nn0.4x264DWr3QVjgPQYqf73QdAypfhKXvuVxw3LW9QYyGM";function g(){let[e,i]=(0,s.useState)({show:!1,type:"",message:"",title:"",onConfirm:null,data:null}),[a,o]=(0,s.useState)([]),[m,x]=(0,s.useState)(!0),[b,g]=(0,s.useState)(0),[k,w]=(0,s.useState)(!1),[j,v]=(0,s.useState)(null),[z,N]=(0,s.useState)(!1),[C,_]=(0,s.useState)(null),M=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;i({show:!0,type:e,message:a,onConfirm:t,title:o,data:r})};(0,s.useEffect)(()=>{q()},[]);let q=async()=>{let e=localStorage.getItem("anime_user"),i=new URLSearchParams(window.location.search),a=i.get("anime_id"),t=i.get("anime_title");if(!a){M("error","Anime ID topilmadi!",()=>{window.location.href="/admin"});return}if(e){let i=JSON.parse(e);"Malika"===i.username?(v(i),_({id:a,title:decodeURIComponent(t||"Anime")}),await Z(a)):M("error","Sizda admin panelga kirish huquqi yo'q!",()=>{window.location.href="/"})}else M("error","Iltimos avval tizimga kiring!",()=>{window.location.href="/"});N(!0)},Z=async e=>{x(!0);try{let i=await fetch("".concat(u,"/rest/v1/anime_episodes?anime_id=eq.").concat(e,"&order=episode_number.asc"),{headers:{apikey:h,Authorization:"Bearer ".concat(h)}});if(!i.ok)throw Error("Ma'lumotlarni yuklashda xato");let a=await i.json();o(a||[])}catch(e){console.error("Error loading episodes:",e),M("error","Qismlarni yuklashda xato: "+e.message)}x(!1)},I=async(e,i)=>{let a=new FormData;a.append("video",e),a.append("episode_number",i),a.append("anime_id",C.id);let t=await fetch("/api/upload-video",{method:"POST",body:a});if(!t.ok)throw Error((await t.json()).error||"Video yuklashda xato");return await t.json()},E=e=>{M("form","",null,"Qismni tahrirlash",e)},S=(e,i)=>{M("error","".concat(i,"-qismni o'chirmoqchimisiz?"),async()=>{try{if(!(await fetch("".concat(u,"/rest/v1/anime_episodes?id=eq.").concat(e),{method:"DELETE",headers:{apikey:h,Authorization:"Bearer ".concat(h),"Content-Type":"application/json"}})).ok)throw Error("O'chirishda xato");M("success","Qism muvaffaqiyatli o'chirildi!"),Z(C.id)}catch(e){M("error","Xato: "+e.message)}})};return z&&j&&"Malika"===j.username?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r(),{id:"18cbddfd3764fd83",children:'*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;outline:none}body{font-family:"Courier New",Courier,monospace;background:#000;color:#fff;padding:20px;min-height:100vh}.episodes-container{max-width:1400px;margin:0 auto}.episodes-header{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:40px;padding:30px;background:#000;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;border:2px solid#fff;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:15px}.header-left{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:20px}.back-btn{background:#000;border:2px solid#fff;color:#fff;padding:12px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.back-btn:hover{background:#fff;color:#000}.episodes-title{font-size:28px;font-weight:700;color:#fff;font-family:"Courier New",Courier,monospace;text-transform:uppercase;letter-spacing:2px}.add-episode-btn{background:#000;color:#fff;border:2px solid#fff;padding:14px 28px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;cursor:pointer;font-size:15px;font-weight:700;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:10px;font-family:"Courier New",Courier,monospace;text-transform:uppercase}.add-episode-btn:hover{background:#fff;color:#000}.episodes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:24px;margin-bottom:40px}.episode-card{background:#000;border:2px solid#fff;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;overflow:hidden;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.episode-card:hover{-webkit-transform:translatey(-4px);-moz-transform:translatey(-4px);-ms-transform:translatey(-4px);-o-transform:translatey(-4px);transform:translatey(-4px);-webkit-box-shadow:8px 8px 0#fff;-moz-box-shadow:8px 8px 0#fff;box-shadow:8px 8px 0#fff}.episode-content{padding:24px}.episode-number{font-size:20px;font-weight:700;margin-bottom:12px;color:#fff;font-family:"Courier New",Courier,monospace;text-transform:uppercase}.episode-title{font-size:16px;font-weight:600;margin-bottom:8px;color:#fff;font-family:"Courier New",Courier,monospace}.episode-description{font-size:14px;color:#fff;margin-bottom:16px;line-height:1.5;font-family:"Courier New",Courier,monospace;max-height:60px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.episode-actions{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:10px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.episode-btn{background:#000;border:2px solid#fff;color:#fff;padding:10px 16px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;cursor:pointer;font-size:13px;font-weight:600;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:6px;font-family:"Courier New",Courier,monospace;text-transform:uppercase;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.episode-btn:hover{background:#fff;color:#000}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.95);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:9999;padding:20px;overflow-y:auto}.modal{background:#000;border:2px solid#fff;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:40px;max-width:600px;width:100%;max-height:90vh;overflow-y:auto}.modal-header{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid#fff}.modal-title{font-size:24px;font-weight:700;color:#fff;font-family:"Courier New",Courier,monospace;text-transform:uppercase}.modal-close{background:#000;border:2px solid#fff;color:#fff;cursor:pointer;padding:0;width:36px;height:36px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.modal-close:hover{background:#fff;color:#000}.form-group{margin-bottom:24px}.form-label{display:block;margin-bottom:10px;font-size:14px;font-weight:600;color:#fff;font-family:"Courier New",Courier,monospace;text-transform:uppercase}.form-input,.form-textarea{width:100%;padding:14px 16px;background:#000;border:2px solid#fff;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;color:#fff;font-size:15px;font-family:"Courier New",Courier,monospace;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.form-textarea{min-height:100px;resize:vertical}.form-input:focus,.form-textarea:focus{outline:none;background:#000}.form-file-upload{border:2px dashed#fff;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:40px 110px;text-align:center;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;background:#000}.form-file-upload:hover{background:#111}.form-file-upload input{display:none}.file-upload-text{color:#fff;font-size:14px;display:none;margin-top:12px;font-family:"Courier New",Courier,monospace}.modal-actions{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:12px;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;margin-top:60px}.modal-btn{padding:12px 28px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;border:2px solid#fff;font-weight:700;cursor:pointer;font-size:15px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-family:"Courier New",Courier,monospace;text-transform:uppercase}.modal-btn.primary{background:#000;color:#fff}.modal-btn.primary:hover{background:#fff;color:#000}.modal-btn.secondary{background:#000;color:#fff}.modal-btn.secondary:hover{background:#fff;color:#000}.modal-btn:disabled{opacity:.5;cursor:not-allowed}.loading{text-align:center;padding:60px;color:#fff;font-size:16px;font-family:"Courier New",Courier,monospace}.empty-state{text-align:center;padding:80px 20px;color:#fff;grid-column:1/-1;font-size:18px;font-family:"Courier New",Courier,monospace}.alert-modal{max-width:400px}.alert-icon{width:64px;height:64px;border:2px solid#fff;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:0 auto 24px;font-size:32px}.alert-message{text-align:center;line-height:1.6;margin-bottom:30px;color:#fff;font-size:16px;font-family:"Courier New",Courier,monospace}.progress-container{margin-top:24px;padding:24px;background:#000;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;border:2px solid#fff}.progress-label{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:12px;font-size:14px;font-weight:600;color:#fff;font-family:"Courier New",Courier,monospace}.progress-bar-bg{width:100%;height:10px;background:#000;border:2px solid#fff;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;overflow:hidden}.progress-bar-fill{height:100%;background:#fff;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-transition:width.3s ease;-moz-transition:width.3s ease;-o-transition:width.3s ease;transition:width.3s ease}.progress-status{margin-top:12px;text-align:center;font-size:13px;color:#fff;font-weight:500;font-family:"Courier New",Courier,monospace}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@media(max-width:900px){.episodes-grid{grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}}@media(max-width:600px){body{padding:15px}.episodes-header{padding:20px}.episodes-title{font-size:20px}.episodes-grid{grid-template-columns:1fr;gap:16px}.modal{padding:24px}}'}),(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 episodes-container",children:[(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 episodes-header",children:[(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 header-left",children:[(0,t.jsx)("button",{onClick:()=>{window.location.href="./admin"},className:"jsx-18cbddfd3764fd83 back-btn",children:(0,t.jsx)(n.Z,{size:20})}),(0,t.jsxs)("h1",{className:"jsx-18cbddfd3764fd83 episodes-title",children:[null==C?void 0:C.title," - Qismlar"]})]}),(0,t.jsxs)("button",{onClick:()=>{M("form","",null,"Qism qo'shish")},className:"jsx-18cbddfd3764fd83 add-episode-btn",children:[(0,t.jsx)(l.Z,{size:20}),"Qism qo'shish"]})]}),(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83 episodes-grid",children:m?(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 loading",children:[(0,t.jsx)(d.Z,{size:24,style:{display:"inline",animation:"spin 1s linear infinite"}})," ","Yuklanmoqda..."]}):0===a.length?(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83 empty-state",children:(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83",children:"Hali qismlar qo'shilmagan"})}):a.map(e=>(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83 episode-card",children:(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 episode-content",children:[(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 episode-number",children:[e.episode_number,"-qism"]}),(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83 episode-title",children:e.title}),e.description&&(0,t.jsx)("div",{className:"jsx-18cbddfd3764fd83 episode-description",children:e.description}),(0,t.jsxs)("div",{className:"jsx-18cbddfd3764fd83 episode-actions",children:[e.video_url&&(0,t.jsxs)("a",{href:e.video_url,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},className:"jsx-18cbddfd3764fd83 episode-btn",children:[(0,t.jsx)(p.Z,{size:14}),"Ko'rish"]}),(0,t.jsxs)("button",{onClick:()=>E(e),className:"jsx-18cbddfd3764fd83 episode-btn",children:[(0,t.jsx)(c.Z,{size:14}),"Tahrirlash"]}),(0,t.jsxs)("button",{onClick:()=>S(e.id,e.episode_number),className:"jsx-18cbddfd3764fd83 episode-btn",children:[(0,t.jsx)(f.Z,{size:14}),"O'chirish"]})]})]})},e.id))})]}),e.show&&(0,t.jsx)(y,{modal:e,hideModal:()=>{i({show:!1,type:"",message:"",title:"",onConfirm:null,data:null})},showModal:M,loadEpisodes:()=>Z(C.id),animeInfo:C,uploadProgress:b,setUploadProgress:g,isUploading:k,setIsUploading:w,uploadToBackend:I,supabaseUrl:u,supabaseKey:h})]}):null}function y(e){let{modal:i,hideModal:a,showModal:o,loadEpisodes:r,animeInfo:n,uploadProgress:l,setUploadProgress:d,isUploading:p,setIsUploading:c,uploadToBackend:f,supabaseUrl:u,supabaseKey:h}=e,[g,y]=(0,s.useState)({episode_number:"",title:"",description:"",duration:"",videoFile:null,video_url:""});(0,s.useEffect)(()=>{"form"===i.type&&i.data&&y({episode_number:i.data.episode_number||"",title:i.data.title||"",description:i.data.description||"",duration:i.data.duration||"",videoFile:null,video_url:i.data.video_url||""})},[i.type,i.data]);let k=async()=>{if(!g.episode_number||!g.title){o("error","Qism raqami va nomini kiriting!");return}if(!i.data&&!g.videoFile){o("error","Iltimos video yuklang!");return}c(!0),d(0);try{d(10);let e=g.video_url;g.videoFile&&(d(20),e=(await f(g.videoFile,g.episode_number)).downloadUrl,d(80));let t={anime_id:n.id,episode_number:parseInt(g.episode_number),title:g.title,description:g.description,video_url:e,duration:parseInt(g.duration)||null};if(!(i.data?await fetch("".concat(u,"/rest/v1/anime_episodes?id=eq.").concat(i.data.id),{method:"PATCH",headers:{apikey:h,Authorization:"Bearer ".concat(h),"Content-Type":"application/json",Prefer:"return=minimal"},body:JSON.stringify(t)}):await fetch("".concat(u,"/rest/v1/anime_episodes"),{method:"POST",headers:{apikey:h,Authorization:"Bearer ".concat(h),"Content-Type":"application/json",Prefer:"return=minimal"},body:JSON.stringify(t)})).ok)throw Error("Ma'lumotlarni saqlashda xato");d(100),setTimeout(()=>{c(!1),d(0),a(),o("success",i.data?"Qism muvaffaqiyatli tahrirlandi!":"Qism muvaffaqiyatli qo'shildi!"),r()},500)}catch(e){console.error("Error:",e),c(!1),d(0),o("error","Xato: "+e.message)}};return"form"===i.type?(0,t.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,t.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h2",{className:"modal-title",children:i.title}),(0,t.jsx)("button",{className:"modal-close",onClick:a,children:(0,t.jsx)(m.Z,{size:20})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:[(0,t.jsx)(x.Z,{size:16,style:{display:"inline",verticalAlign:"middle"}})," ","Qism raqami"]}),(0,t.jsx)("input",{className:"form-input",type:"number",placeholder:"Masalan: 1",value:g.episode_number,onChange:e=>y({...g,episode_number:e.target.value}),disabled:p})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Qism nomi"}),(0,t.jsx)("input",{className:"form-input",type:"text",placeholder:"Masalan: Boshlanish",value:g.title,onChange:e=>y({...g,title:e.target.value}),disabled:p})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Tavsif (ixtiyoriy)"}),(0,t.jsx)("textarea",{className:"form-textarea",placeholder:"Qism haqida qisqacha ma'lumot...",value:g.description,onChange:e=>y({...g,description:e.target.value}),disabled:p})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Davomiylik (soniyalarda, ixtiyoriy)"}),(0,t.jsx)("input",{className:"form-input",type:"number",placeholder:"Masalan: 1200",value:g.duration,onChange:e=>y({...g,duration:e.target.value}),disabled:p})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:[(0,t.jsx)(b.Z,{size:16,style:{display:"inline",verticalAlign:"middle"}})," ","Video yuklash (Max 500MB)"]}),(0,t.jsxs)("label",{className:"form-file-upload",children:[(0,t.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{let i=e.target.files[0];if(i){if(i.size>1048576e4){o("error","Video hajmi 10GB dan oshmasligi kerak!");return}y({...g,videoFile:i})}},disabled:p}),(0,t.jsx)(b.Z,{size:48}),(0,t.jsx)("div",{className:"file-upload-text",children:g.videoFile?g.videoFile.name:i.data?"Yangi video tanlang (ixtiyoriy)":"Video tanlang yoki bu yerga tashlang"})]})]}),p&&(0,t.jsxs)("div",{className:"progress-container",children:[(0,t.jsxs)("div",{className:"progress-label",children:[(0,t.jsx)("span",{children:"Yuklanmoqda..."}),(0,t.jsxs)("span",{children:[l,"%"]})]}),(0,t.jsx)("div",{className:"progress-bar-bg",children:(0,t.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(l,"%")}})}),(0,t.jsxs)("div",{className:"progress-status",children:[l<20&&"Tayyorlanmoqda...",l>=20&&l<80&&"Video Backblaze B2 ga yuklanmoqda...",l>=80&&l<100&&"Ma'lumotlar saqlanmoqda...",100===l&&"Tayyor!"]})]}),(0,t.jsxs)("div",{className:"modal-actions",children:[(0,t.jsx)("button",{className:"modal-btn secondary",onClick:a,type:"button",disabled:p,children:"Bekor qilish"}),(0,t.jsx)("button",{className:"modal-btn primary",onClick:k,type:"button",disabled:p,children:p?"Yuklanmoqda...":i.data?"Yangilash":"Saqlash"})]})]})}):"success"===i.type||"error"===i.type?(0,t.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,t.jsxs)("div",{className:"modal alert-modal",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"alert-icon",children:"success"===i.type?"✓":"✕"}),(0,t.jsx)("div",{className:"alert-message",children:i.message}),(0,t.jsx)("div",{className:"modal-actions",children:i.onConfirm?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"modal-btn secondary",onClick:a,type:"button",children:"Bekor qilish"}),(0,t.jsx)("button",{className:"modal-btn primary",onClick:()=>{i.onConfirm(),a()},type:"button",children:"Tasdiqlash"})]}):(0,t.jsx)("button",{className:"modal-btn primary",onClick:a,type:"button",children:"OK"})})]})}):null}}},function(e){e.O(0,[774,235,888,179],function(){return e(e.s=6328)}),_N_E=e.O()}]);