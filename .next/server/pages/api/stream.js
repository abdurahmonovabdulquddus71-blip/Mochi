"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/stream";
exports.ids = ["pages/api/stream"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "node-fetch":
/*!*****************************!*\
  !*** external "node-fetch" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("node-fetch");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fstream.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fstream.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/stream.js */ \"(api)/./pages/api/stream.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/stream\",\n        pathname: \"/api/stream\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_stream_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnN0cmVhbSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGc3RyZWFtLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ2tEO0FBQ2xEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJpdmF0ZS8/MzU3OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL3N0cmVhbS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N0cmVhbVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N0cmVhbVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fstream.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/stream.js":
/*!*****************************!*\
  !*** ./pages/api/stream.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var node_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node-fetch */ \"node-fetch\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([node_fetch__WEBPACK_IMPORTED_MODULE_0__]);\nnode_fetch__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// âš™ï¸ Backblaze B2 sozlamalari\nconst B2_KEY_ID = \"005388ef1432aec000000000f\";\nconst B2_APPLICATION_KEY = \"K005ChhVWS9ULMO2oxsQwcZzJCZw6tk\";\n// ðŸš€ OPTIMALLASHTIRILGAN CHUNK SIZE\n// YouTube kabi tez yuklash uchun kichikroq qismlar\nconst OPTIMAL_CHUNK_SIZE = 256 * 1024; // 256KB - tezkor boshlanish\nconst MAX_CHUNK_SIZE = 2 * 1024 * 1024; // 2MB - maksimal\n// ðŸ” B2 autentifikatsiya (cache bilan)\nlet cachedAuth = null;\nlet authExpiry = 0;\nasync function authenticateB2() {\n    // Cache'dan foydalanish - har safar auth qilmaslik\n    const now = Date.now();\n    if (cachedAuth && authExpiry > now) {\n        console.log(\"âœ… Using cached B2 auth\");\n        return cachedAuth;\n    }\n    const auth = Buffer.from(`${B2_KEY_ID}:${B2_APPLICATION_KEY}`).toString(\"base64\");\n    const response = await (0,node_fetch__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"https://api.backblazeb2.com/b2api/v2/b2_authorize_account\", {\n        method: \"GET\",\n        headers: {\n            Authorization: `Basic ${auth}`\n        }\n    });\n    if (!response.ok) {\n        const errorText = await response.text();\n        console.error(\"âŒ B2 auth error:\", errorText);\n        throw new Error(\"B2 autentifikatsiya xatosi\");\n    }\n    const authData = await response.json();\n    // 23 soat cache (token 24 soat amal qiladi)\n    cachedAuth = authData;\n    authExpiry = now + 23 * 60 * 60 * 1000;\n    console.log(\"âœ… New B2 auth token obtained\");\n    return authData;\n}\n// ðŸ“¹ ULTRA TEZ VIDEO STREAMING\nasync function handler(req, res) {\n    const startTime = Date.now();\n    // ðŸš€ CORS headers - barcha brauzerlarga ruxsat\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    res.setHeader(\"Access-Control-Allow-Methods\", \"GET, HEAD, OPTIONS\");\n    res.setHeader(\"Access-Control-Allow-Headers\", \"Range, Content-Type, Authorization\");\n    res.setHeader(\"Access-Control-Expose-Headers\", \"Content-Range, Accept-Ranges, Content-Length\");\n    if (req.method === \"OPTIONS\") {\n        return res.status(200).end();\n    }\n    if (req.method !== \"GET\" && req.method !== \"HEAD\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const videoUrl = req.query.fileName;\n        if (!videoUrl) {\n            console.error(\"âŒ fileName parametri yo'q\");\n            return res.status(400).json({\n                error: \"fileName parametri kerak\"\n            });\n        }\n        console.log(\"\\uD83C\\uDFAC Video request:\", videoUrl.substring(0, 80) + \"...\");\n        // URL validatsiya\n        if (!videoUrl.startsWith(\"https://\")) {\n            console.error(\"âŒ Noto'g'ri URL format\");\n            return res.status(400).json({\n                error: \"Video URL https:// bilan boshlanishi kerak\"\n            });\n        }\n        // ðŸ” B2 autentifikatsiya (cached)\n        const b2Auth = await authenticateB2();\n        // ðŸ“Š Video meta ma'lumotlarini olish (HEAD request - juda tez)\n        const headResponse = await (0,node_fetch__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(videoUrl, {\n            method: \"HEAD\",\n            headers: {\n                Authorization: b2Auth.authorizationToken\n            }\n        });\n        if (!headResponse.ok) {\n            console.error(\"âŒ Video topilmadi:\", headResponse.status);\n            return res.status(404).json({\n                error: \"Video topilmadi\"\n            });\n        }\n        const contentLength = parseInt(headResponse.headers.get(\"content-length\") || \"0\");\n        const contentType = headResponse.headers.get(\"content-type\") || \"video/mp4\";\n        console.log(`ðŸ“Š Video: ${(contentLength / 1024 / 1024).toFixed(2)}MB (${contentType})`);\n        // HEAD request uchun\n        if (req.method === \"HEAD\") {\n            res.writeHead(200, {\n                \"Content-Type\": contentType,\n                \"Content-Length\": contentLength,\n                \"Accept-Ranges\": \"bytes\",\n                \"Cache-Control\": \"public, max-age=31536000\"\n            });\n            return res.end();\n        }\n        // ðŸŽ¯ Range parsing - video playerlar uchun\n        const range = req.headers.range;\n        let start = 0;\n        let end = contentLength - 1;\n        let statusCode = 200;\n        if (range) {\n            // ðŸ“¦ PARTIAL CONTENT - qismlar bo'lib yuklash\n            const parts = range.replace(/bytes=/, \"\").split(\"-\");\n            start = parseInt(parts[0], 10);\n            // Agar end ko'rsatilgan bo'lsa\n            if (parts[1]) {\n                end = parseInt(parts[1], 10);\n            } else {\n                // Aks holda optimal chunk size\n                end = Math.min(start + OPTIMAL_CHUNK_SIZE - 1, contentLength - 1);\n            }\n            // Validation\n            if (start >= contentLength) {\n                res.writeHead(416, {\n                    \"Content-Range\": `bytes */${contentLength}`\n                });\n                return res.end();\n            }\n            if (end >= contentLength) {\n                end = contentLength - 1;\n            }\n            if (start > end) {\n                return res.status(416).end();\n            }\n            statusCode = 206;\n            const chunkKB = ((end - start + 1) / 1024).toFixed(2);\n            console.log(`ðŸ“¦ Chunk: ${start}-${end} (${chunkKB}KB)`);\n        } else {\n            // Range bo'lmasa ham kichik qism yuborish (tezroq boshlanish)\n            end = Math.min(OPTIMAL_CHUNK_SIZE - 1, contentLength - 1);\n            statusCode = 206;\n            console.log(`ðŸš€ Initial chunk: 0-${end} (${(end / 1024).toFixed(2)}KB)`);\n        }\n        const chunkSize = end - start + 1;\n        // ðŸŽ¬ B2 dan video qismini olish\n        const videoResponse = await (0,node_fetch__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(videoUrl, {\n            method: \"GET\",\n            headers: {\n                Authorization: b2Auth.authorizationToken,\n                Range: `bytes=${start}-${end}`\n            }\n        });\n        if (!videoResponse.ok) {\n            console.error(\"âŒ B2 stream error:\", videoResponse.status);\n            return res.status(500).json({\n                error: \"Video stream xatosi\"\n            });\n        }\n        // ðŸš€ OPTIMAL RESPONSE HEADERS\n        const headers = {\n            \"Content-Type\": contentType,\n            \"Accept-Ranges\": \"bytes\",\n            \"Content-Range\": `bytes ${start}-${end}/${contentLength}`,\n            \"Content-Length\": chunkSize,\n            // Cache strategiyasi - tez yuklash uchun\n            \"Cache-Control\": \"public, max-age=31536000, immutable\",\n            \"ETag\": `\"${contentLength}-${start}-${end}\"`,\n            // Connection optimizatsiyasi\n            \"Connection\": \"keep-alive\",\n            \"Keep-Alive\": \"timeout=5, max=100\",\n            // Compression (agar kerak bo'lsa)\n            \"Vary\": \"Accept-Encoding\"\n        };\n        res.writeHead(statusCode, headers);\n        // ðŸ“º STREAM QILISH - backpressure bilan\n        if (videoResponse.body) {\n            let bytesStreamed = 0;\n            const reader = videoResponse.body;\n            for await (const chunk of reader){\n                bytesStreamed += chunk.length;\n                // Backpressure handling - buffer to'lsa kutish\n                if (!res.write(chunk)) {\n                    await new Promise((resolve)=>res.once(\"drain\", resolve));\n                }\n                // Progress log (har 100KB da)\n                if (bytesStreamed % (100 * 1024) < chunk.length) {\n                    const progress = (bytesStreamed / chunkSize * 100).toFixed(1);\n                    console.log(`âš¡ Streaming: ${progress}%`);\n                }\n            }\n            const duration = Date.now() - startTime;\n            const speed = (bytesStreamed / 1024 / (duration / 1000)).toFixed(2);\n            console.log(`âœ… Stream complete: ${(bytesStreamed / 1024).toFixed(2)}KB in ${duration}ms (${speed}KB/s)`);\n        }\n        res.end();\n    } catch (error) {\n        console.error(\"âŒ Stream error:\", error);\n        if (!res.headersSent) {\n            return res.status(500).json({\n                error: \"Video streaming xatosi\",\n                details: error.message\n            });\n        }\n        res.end();\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc3RyZWFtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQStCO0FBRS9CLDhCQUE4QjtBQUM5QixNQUFNQyxZQUFZO0FBQ2xCLE1BQU1DLHFCQUFxQjtBQUUzQixvQ0FBb0M7QUFDcEMsbURBQW1EO0FBQ25ELE1BQU1DLHFCQUFxQixNQUFNLE1BQU0sNEJBQTRCO0FBQ25FLE1BQU1DLGlCQUFpQixJQUFJLE9BQU8sTUFBTSxpQkFBaUI7QUFFekQsdUNBQXVDO0FBQ3ZDLElBQUlDLGFBQWE7QUFDakIsSUFBSUMsYUFBYTtBQUVqQixlQUFlQztJQUNiLG1EQUFtRDtJQUNuRCxNQUFNQyxNQUFNQyxLQUFLRCxHQUFHO0lBQ3BCLElBQUlILGNBQWNDLGFBQWFFLEtBQUs7UUFDbENFLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9OO0lBQ1Q7SUFFQSxNQUFNTyxPQUFPQyxPQUFPQyxJQUFJLENBQUMsQ0FBQyxFQUFFYixVQUFVLENBQUMsRUFBRUMsbUJBQW1CLENBQUMsRUFBRWEsUUFBUSxDQUFDO0lBRXhFLE1BQU1DLFdBQVcsTUFBTWhCLHNEQUFLQSxDQUFDLDZEQUE2RDtRQUN4RmlCLFFBQVE7UUFDUkMsU0FBUztZQUFFQyxlQUFlLENBQUMsTUFBTSxFQUFFUCxLQUFLLENBQUM7UUFBQztJQUM1QztJQUVBLElBQUksQ0FBQ0ksU0FBU0ksRUFBRSxFQUFFO1FBQ2hCLE1BQU1DLFlBQVksTUFBTUwsU0FBU00sSUFBSTtRQUNyQ1osUUFBUWEsS0FBSyxDQUFDLG9CQUFvQkY7UUFDbEMsTUFBTSxJQUFJRyxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsV0FBVyxNQUFNVCxTQUFTVSxJQUFJO0lBRXBDLDRDQUE0QztJQUM1Q3JCLGFBQWFvQjtJQUNibkIsYUFBYUUsTUFBTyxLQUFLLEtBQUssS0FBSztJQUVuQ0UsUUFBUUMsR0FBRyxDQUFDO0lBQ1osT0FBT2M7QUFDVDtBQUVBLCtCQUErQjtBQUNoQixlQUFlRSxRQUFRQyxHQUFHLEVBQUVDLEdBQUc7SUFDNUMsTUFBTUMsWUFBWXJCLEtBQUtELEdBQUc7SUFFMUIsK0NBQStDO0lBQy9DcUIsSUFBSUUsU0FBUyxDQUFDLCtCQUErQjtJQUM3Q0YsSUFBSUUsU0FBUyxDQUFDLGdDQUFnQztJQUM5Q0YsSUFBSUUsU0FBUyxDQUFDLGdDQUFnQztJQUM5Q0YsSUFBSUUsU0FBUyxDQUFDLGlDQUFpQztJQUUvQyxJQUFJSCxJQUFJWCxNQUFNLEtBQUssV0FBVztRQUM1QixPQUFPWSxJQUFJRyxNQUFNLENBQUMsS0FBS0MsR0FBRztJQUM1QjtJQUVBLElBQUlMLElBQUlYLE1BQU0sS0FBSyxTQUFTVyxJQUFJWCxNQUFNLEtBQUssUUFBUTtRQUNqRCxPQUFPWSxJQUFJRyxNQUFNLENBQUMsS0FBS04sSUFBSSxDQUFDO1lBQUVILE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTVcsV0FBV04sSUFBSU8sS0FBSyxDQUFDQyxRQUFRO1FBRW5DLElBQUksQ0FBQ0YsVUFBVTtZQUNieEIsUUFBUWEsS0FBSyxDQUFDO1lBQ2QsT0FBT00sSUFBSUcsTUFBTSxDQUFDLEtBQUtOLElBQUksQ0FBQztnQkFBRUgsT0FBTztZQUEyQjtRQUNsRTtRQUVBYixRQUFRQyxHQUFHLENBQUMsK0JBQXFCdUIsU0FBU0csU0FBUyxDQUFDLEdBQUcsTUFBTTtRQUU3RCxrQkFBa0I7UUFDbEIsSUFBSSxDQUFDSCxTQUFTSSxVQUFVLENBQUMsYUFBYTtZQUNwQzVCLFFBQVFhLEtBQUssQ0FBQztZQUNkLE9BQU9NLElBQUlHLE1BQU0sQ0FBQyxLQUFLTixJQUFJLENBQUM7Z0JBQUVILE9BQU87WUFBNkM7UUFDcEY7UUFFQSxrQ0FBa0M7UUFDbEMsTUFBTWdCLFNBQVMsTUFBTWhDO1FBRXJCLCtEQUErRDtRQUMvRCxNQUFNaUMsZUFBZSxNQUFNeEMsc0RBQUtBLENBQUNrQyxVQUFVO1lBQ3pDakIsUUFBUTtZQUNSQyxTQUFTO2dCQUNQQyxlQUFlb0IsT0FBT0Usa0JBQWtCO1lBQzFDO1FBQ0Y7UUFFQSxJQUFJLENBQUNELGFBQWFwQixFQUFFLEVBQUU7WUFDcEJWLFFBQVFhLEtBQUssQ0FBQyxzQkFBc0JpQixhQUFhUixNQUFNO1lBQ3ZELE9BQU9ILElBQUlHLE1BQU0sQ0FBQyxLQUFLTixJQUFJLENBQUM7Z0JBQUVILE9BQU87WUFBa0I7UUFDekQ7UUFFQSxNQUFNbUIsZ0JBQWdCQyxTQUFTSCxhQUFhdEIsT0FBTyxDQUFDMEIsR0FBRyxDQUFDLHFCQUFxQjtRQUM3RSxNQUFNQyxjQUFjTCxhQUFhdEIsT0FBTyxDQUFDMEIsR0FBRyxDQUFDLG1CQUFtQjtRQUVoRWxDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDK0IsZ0JBQWdCLE9BQU8sSUFBRyxFQUFHSSxPQUFPLENBQUMsR0FBRyxJQUFJLEVBQUVELFlBQVksQ0FBQyxDQUFDO1FBRXRGLHFCQUFxQjtRQUNyQixJQUFJakIsSUFBSVgsTUFBTSxLQUFLLFFBQVE7WUFDekJZLElBQUlrQixTQUFTLENBQUMsS0FBSztnQkFDakIsZ0JBQWdCRjtnQkFDaEIsa0JBQWtCSDtnQkFDbEIsaUJBQWlCO2dCQUNqQixpQkFBaUI7WUFDbkI7WUFDQSxPQUFPYixJQUFJSSxHQUFHO1FBQ2hCO1FBRUEsMkNBQTJDO1FBQzNDLE1BQU1lLFFBQVFwQixJQUFJVixPQUFPLENBQUM4QixLQUFLO1FBQy9CLElBQUlDLFFBQVE7UUFDWixJQUFJaEIsTUFBTVMsZ0JBQWdCO1FBQzFCLElBQUlRLGFBQWE7UUFFakIsSUFBSUYsT0FBTztZQUNULDhDQUE4QztZQUM5QyxNQUFNRyxRQUFRSCxNQUFNSSxPQUFPLENBQUMsVUFBVSxJQUFJQyxLQUFLLENBQUM7WUFDaERKLFFBQVFOLFNBQVNRLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFFM0IsK0JBQStCO1lBQy9CLElBQUlBLEtBQUssQ0FBQyxFQUFFLEVBQUU7Z0JBQ1psQixNQUFNVSxTQUFTUSxLQUFLLENBQUMsRUFBRSxFQUFFO1lBQzNCLE9BQU87Z0JBQ0wsK0JBQStCO2dCQUMvQmxCLE1BQU1xQixLQUFLQyxHQUFHLENBQUNOLFFBQVE5QyxxQkFBcUIsR0FBR3VDLGdCQUFnQjtZQUNqRTtZQUVBLGFBQWE7WUFDYixJQUFJTyxTQUFTUCxlQUFlO2dCQUMxQmIsSUFBSWtCLFNBQVMsQ0FBQyxLQUFLO29CQUNqQixpQkFBaUIsQ0FBQyxRQUFRLEVBQUVMLGNBQWMsQ0FBQztnQkFDN0M7Z0JBQ0EsT0FBT2IsSUFBSUksR0FBRztZQUNoQjtZQUVBLElBQUlBLE9BQU9TLGVBQWU7Z0JBQ3hCVCxNQUFNUyxnQkFBZ0I7WUFDeEI7WUFFQSxJQUFJTyxRQUFRaEIsS0FBSztnQkFDZixPQUFPSixJQUFJRyxNQUFNLENBQUMsS0FBS0MsR0FBRztZQUM1QjtZQUVBaUIsYUFBYTtZQUNiLE1BQU1NLFVBQVUsQ0FBQyxDQUFDdkIsTUFBTWdCLFFBQVEsS0FBSyxJQUFHLEVBQUdILE9BQU8sQ0FBQztZQUNuRHBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRXNDLE1BQU0sQ0FBQyxFQUFFaEIsSUFBSSxFQUFFLEVBQUV1QixRQUFRLEdBQUcsQ0FBQztRQUN4RCxPQUFPO1lBQ0wsOERBQThEO1lBQzlEdkIsTUFBTXFCLEtBQUtDLEdBQUcsQ0FBQ3BELHFCQUFxQixHQUFHdUMsZ0JBQWdCO1lBQ3ZEUSxhQUFhO1lBQ2J4QyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxvQkFBb0IsRUFBRXNCLElBQUksRUFBRSxFQUFFLENBQUNBLE1BQU0sSUFBRyxFQUFHYSxPQUFPLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDekU7UUFFQSxNQUFNVyxZQUFZeEIsTUFBTWdCLFFBQVE7UUFFaEMsZ0NBQWdDO1FBQ2hDLE1BQU1TLGdCQUFnQixNQUFNMUQsc0RBQUtBLENBQUNrQyxVQUFVO1lBQzFDakIsUUFBUTtZQUNSQyxTQUFTO2dCQUNQQyxlQUFlb0IsT0FBT0Usa0JBQWtCO2dCQUN4Q2tCLE9BQU8sQ0FBQyxNQUFNLEVBQUVWLE1BQU0sQ0FBQyxFQUFFaEIsSUFBSSxDQUFDO1lBQ2hDO1FBQ0Y7UUFFQSxJQUFJLENBQUN5QixjQUFjdEMsRUFBRSxFQUFFO1lBQ3JCVixRQUFRYSxLQUFLLENBQUMsc0JBQXNCbUMsY0FBYzFCLE1BQU07WUFDeEQsT0FBT0gsSUFBSUcsTUFBTSxDQUFDLEtBQUtOLElBQUksQ0FBQztnQkFBRUgsT0FBTztZQUFzQjtRQUM3RDtRQUVBLDhCQUE4QjtRQUM5QixNQUFNTCxVQUFVO1lBQ2QsZ0JBQWdCMkI7WUFDaEIsaUJBQWlCO1lBQ2pCLGlCQUFpQixDQUFDLE1BQU0sRUFBRUksTUFBTSxDQUFDLEVBQUVoQixJQUFJLENBQUMsRUFBRVMsY0FBYyxDQUFDO1lBQ3pELGtCQUFrQmU7WUFFbEIseUNBQXlDO1lBQ3pDLGlCQUFpQjtZQUNqQixRQUFRLENBQUMsQ0FBQyxFQUFFZixjQUFjLENBQUMsRUFBRU8sTUFBTSxDQUFDLEVBQUVoQixJQUFJLENBQUMsQ0FBQztZQUU1Qyw2QkFBNkI7WUFDN0IsY0FBYztZQUNkLGNBQWM7WUFFZCxrQ0FBa0M7WUFDbEMsUUFBUTtRQUNWO1FBRUFKLElBQUlrQixTQUFTLENBQUNHLFlBQVloQztRQUUxQix3Q0FBd0M7UUFDeEMsSUFBSXdDLGNBQWNFLElBQUksRUFBRTtZQUN0QixJQUFJQyxnQkFBZ0I7WUFDcEIsTUFBTUMsU0FBU0osY0FBY0UsSUFBSTtZQUVqQyxXQUFXLE1BQU1HLFNBQVNELE9BQVE7Z0JBQ2hDRCxpQkFBaUJFLE1BQU1DLE1BQU07Z0JBRTdCLCtDQUErQztnQkFDL0MsSUFBSSxDQUFDbkMsSUFBSW9DLEtBQUssQ0FBQ0YsUUFBUTtvQkFDckIsTUFBTSxJQUFJRyxRQUFRQyxDQUFBQSxVQUFXdEMsSUFBSXVDLElBQUksQ0FBQyxTQUFTRDtnQkFDakQ7Z0JBRUEsOEJBQThCO2dCQUM5QixJQUFJTixnQkFBaUIsT0FBTSxJQUFHLElBQUtFLE1BQU1DLE1BQU0sRUFBRTtvQkFDL0MsTUFBTUssV0FBVyxDQUFDLGdCQUFpQlosWUFBYSxHQUFFLEVBQUdYLE9BQU8sQ0FBQztvQkFDN0RwQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxhQUFhLEVBQUUwRCxTQUFTLENBQUMsQ0FBQztnQkFDekM7WUFDRjtZQUVBLE1BQU1DLFdBQVc3RCxLQUFLRCxHQUFHLEtBQUtzQjtZQUM5QixNQUFNeUMsUUFBUSxDQUFDVixnQkFBZ0IsT0FBUVMsQ0FBQUEsV0FBVyxJQUFHLENBQUMsRUFBR3hCLE9BQU8sQ0FBQztZQUNqRXBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFLENBQUNrRCxnQkFBZ0IsSUFBRyxFQUFHZixPQUFPLENBQUMsR0FBRyxNQUFNLEVBQUV3QixTQUFTLElBQUksRUFBRUMsTUFBTSxLQUFLLENBQUM7UUFDekc7UUFFQTFDLElBQUlJLEdBQUc7SUFFVCxFQUFFLE9BQU9WLE9BQU87UUFDZGIsUUFBUWEsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsSUFBSSxDQUFDTSxJQUFJMkMsV0FBVyxFQUFFO1lBQ3BCLE9BQU8zQyxJQUFJRyxNQUFNLENBQUMsS0FBS04sSUFBSSxDQUFDO2dCQUMxQkgsT0FBTztnQkFDUGtELFNBQVNsRCxNQUFNbUQsT0FBTztZQUN4QjtRQUNGO1FBQ0E3QyxJQUFJSSxHQUFHO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByaXZhdGUvLi9wYWdlcy9hcGkvc3RyZWFtLmpzPzZiYTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZldGNoIGZyb20gXCJub2RlLWZldGNoXCI7XG5cbi8vIOKame+4jyBCYWNrYmxhemUgQjIgc296bGFtYWxhcmlcbmNvbnN0IEIyX0tFWV9JRCA9IFwiMDA1Mzg4ZWYxNDMyYWVjMDAwMDAwMDAwZlwiO1xuY29uc3QgQjJfQVBQTElDQVRJT05fS0VZID0gXCJLMDA1Q2hoVldTOVVMTU8yb3hzUXdjWnpKQ1p3NnRrXCI7XG5cbi8vIPCfmoAgT1BUSU1BTExBU0hUSVJJTEdBTiBDSFVOSyBTSVpFXG4vLyBZb3VUdWJlIGthYmkgdGV6IHl1a2xhc2ggdWNodW4ga2ljaGlrcm9xIHFpc21sYXJcbmNvbnN0IE9QVElNQUxfQ0hVTktfU0laRSA9IDI1NiAqIDEwMjQ7IC8vIDI1NktCIC0gdGV6a29yIGJvc2hsYW5pc2hcbmNvbnN0IE1BWF9DSFVOS19TSVpFID0gMiAqIDEwMjQgKiAxMDI0OyAvLyAyTUIgLSBtYWtzaW1hbFxuXG4vLyDwn5SQIEIyIGF1dGVudGlmaWthdHNpeWEgKGNhY2hlIGJpbGFuKVxubGV0IGNhY2hlZEF1dGggPSBudWxsO1xubGV0IGF1dGhFeHBpcnkgPSAwO1xuXG5hc3luYyBmdW5jdGlvbiBhdXRoZW50aWNhdGVCMigpIHtcbiAgLy8gQ2FjaGUnZGFuIGZveWRhbGFuaXNoIC0gaGFyIHNhZmFyIGF1dGggcWlsbWFzbGlrXG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGlmIChjYWNoZWRBdXRoICYmIGF1dGhFeHBpcnkgPiBub3cpIHtcbiAgICBjb25zb2xlLmxvZyhcIuKchSBVc2luZyBjYWNoZWQgQjIgYXV0aFwiKTtcbiAgICByZXR1cm4gY2FjaGVkQXV0aDtcbiAgfVxuXG4gIGNvbnN0IGF1dGggPSBCdWZmZXIuZnJvbShgJHtCMl9LRVlfSUR9OiR7QjJfQVBQTElDQVRJT05fS0VZfWApLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuICBcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcImh0dHBzOi8vYXBpLmJhY2tibGF6ZWIyLmNvbS9iMmFwaS92Mi9iMl9hdXRob3JpemVfYWNjb3VudFwiLCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7YXV0aH1gIH0sXG4gIH0pO1xuXG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBCMiBhdXRoIGVycm9yOlwiLCBlcnJvclRleHQpO1xuICAgIHRocm93IG5ldyBFcnJvcihcIkIyIGF1dGVudGlmaWthdHNpeWEgeGF0b3NpXCIpO1xuICB9XG5cbiAgY29uc3QgYXV0aERhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIFxuICAvLyAyMyBzb2F0IGNhY2hlICh0b2tlbiAyNCBzb2F0IGFtYWwgcWlsYWRpKVxuICBjYWNoZWRBdXRoID0gYXV0aERhdGE7XG4gIGF1dGhFeHBpcnkgPSBub3cgKyAoMjMgKiA2MCAqIDYwICogMTAwMCk7XG4gIFxuICBjb25zb2xlLmxvZyhcIuKchSBOZXcgQjIgYXV0aCB0b2tlbiBvYnRhaW5lZFwiKTtcbiAgcmV0dXJuIGF1dGhEYXRhO1xufVxuXG4vLyDwn5O5IFVMVFJBIFRFWiBWSURFTyBTVFJFQU1JTkdcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgXG4gIC8vIPCfmoAgQ09SUyBoZWFkZXJzIC0gYmFyY2hhIGJyYXV6ZXJsYXJnYSBydXhzYXRcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgJyonKTtcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsIEhFQUQsIE9QVElPTlMnKTtcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycycsICdSYW5nZSwgQ29udGVudC1UeXBlLCBBdXRob3JpemF0aW9uJyk7XG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUV4cG9zZS1IZWFkZXJzJywgJ0NvbnRlbnQtUmFuZ2UsIEFjY2VwdC1SYW5nZXMsIENvbnRlbnQtTGVuZ3RoJyk7XG5cbiAgaWYgKHJlcS5tZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuZW5kKCk7XG4gIH1cblxuICBpZiAocmVxLm1ldGhvZCAhPT0gXCJHRVRcIiAmJiByZXEubWV0aG9kICE9PSBcIkhFQURcIikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBcIk1ldGhvZCBub3QgYWxsb3dlZFwiIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB2aWRlb1VybCA9IHJlcS5xdWVyeS5maWxlTmFtZTtcblxuICAgIGlmICghdmlkZW9VcmwpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgZmlsZU5hbWUgcGFyYW1ldHJpIHlvJ3FcIik7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJmaWxlTmFtZSBwYXJhbWV0cmkga2VyYWtcIiB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfjqwgVmlkZW8gcmVxdWVzdDpcIiwgdmlkZW9Vcmwuc3Vic3RyaW5nKDAsIDgwKSArIFwiLi4uXCIpO1xuXG4gICAgLy8gVVJMIHZhbGlkYXRzaXlhXG4gICAgaWYgKCF2aWRlb1VybC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIE5vdG8nZydyaSBVUkwgZm9ybWF0XCIpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IFwiVmlkZW8gVVJMIGh0dHBzOi8vIGJpbGFuIGJvc2hsYW5pc2hpIGtlcmFrXCIgfSk7XG4gICAgfVxuXG4gICAgLy8g8J+UkCBCMiBhdXRlbnRpZmlrYXRzaXlhIChjYWNoZWQpXG4gICAgY29uc3QgYjJBdXRoID0gYXdhaXQgYXV0aGVudGljYXRlQjIoKTtcblxuICAgIC8vIPCfk4ogVmlkZW8gbWV0YSBtYSdsdW1vdGxhcmluaSBvbGlzaCAoSEVBRCByZXF1ZXN0IC0ganVkYSB0ZXopXG4gICAgY29uc3QgaGVhZFJlc3BvbnNlID0gYXdhaXQgZmV0Y2godmlkZW9VcmwsIHtcbiAgICAgIG1ldGhvZDogXCJIRUFEXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGIyQXV0aC5hdXRob3JpemF0aW9uVG9rZW4sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKCFoZWFkUmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgVmlkZW8gdG9waWxtYWRpOlwiLCBoZWFkUmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiBcIlZpZGVvIHRvcGlsbWFkaVwiIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbnRlbnRMZW5ndGggPSBwYXJzZUludChoZWFkUmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LWxlbmd0aFwiKSB8fCBcIjBcIik7XG4gICAgY29uc3QgY29udGVudFR5cGUgPSBoZWFkUmVzcG9uc2UuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIikgfHwgXCJ2aWRlby9tcDRcIjtcblxuICAgIGNvbnNvbGUubG9nKGDwn5OKIFZpZGVvOiAkeyhjb250ZW50TGVuZ3RoIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUIgKCR7Y29udGVudFR5cGV9KWApO1xuXG4gICAgLy8gSEVBRCByZXF1ZXN0IHVjaHVuXG4gICAgaWYgKHJlcS5tZXRob2QgPT09IFwiSEVBRFwiKSB7XG4gICAgICByZXMud3JpdGVIZWFkKDIwMCwge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBjb250ZW50VHlwZSxcbiAgICAgICAgXCJDb250ZW50LUxlbmd0aFwiOiBjb250ZW50TGVuZ3RoLFxuICAgICAgICBcIkFjY2VwdC1SYW5nZXNcIjogXCJieXRlc1wiLFxuICAgICAgICBcIkNhY2hlLUNvbnRyb2xcIjogXCJwdWJsaWMsIG1heC1hZ2U9MzE1MzYwMDBcIiwgLy8gMSB5aWwgY2FjaGVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlcy5lbmQoKTtcbiAgICB9XG5cbiAgICAvLyDwn46vIFJhbmdlIHBhcnNpbmcgLSB2aWRlbyBwbGF5ZXJsYXIgdWNodW5cbiAgICBjb25zdCByYW5nZSA9IHJlcS5oZWFkZXJzLnJhbmdlO1xuICAgIGxldCBzdGFydCA9IDA7XG4gICAgbGV0IGVuZCA9IGNvbnRlbnRMZW5ndGggLSAxO1xuICAgIGxldCBzdGF0dXNDb2RlID0gMjAwO1xuXG4gICAgaWYgKHJhbmdlKSB7XG4gICAgICAvLyDwn5OmIFBBUlRJQUwgQ09OVEVOVCAtIHFpc21sYXIgYm8nbGliIHl1a2xhc2hcbiAgICAgIGNvbnN0IHBhcnRzID0gcmFuZ2UucmVwbGFjZSgvYnl0ZXM9LywgXCJcIikuc3BsaXQoXCItXCIpO1xuICAgICAgc3RhcnQgPSBwYXJzZUludChwYXJ0c1swXSwgMTApO1xuICAgICAgXG4gICAgICAvLyBBZ2FyIGVuZCBrbydyc2F0aWxnYW4gYm8nbHNhXG4gICAgICBpZiAocGFydHNbMV0pIHtcbiAgICAgICAgZW5kID0gcGFyc2VJbnQocGFydHNbMV0sIDEwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEFrcyBob2xkYSBvcHRpbWFsIGNodW5rIHNpemVcbiAgICAgICAgZW5kID0gTWF0aC5taW4oc3RhcnQgKyBPUFRJTUFMX0NIVU5LX1NJWkUgLSAxLCBjb250ZW50TGVuZ3RoIC0gMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRpb25cbiAgICAgIGlmIChzdGFydCA+PSBjb250ZW50TGVuZ3RoKSB7XG4gICAgICAgIHJlcy53cml0ZUhlYWQoNDE2LCB7XG4gICAgICAgICAgXCJDb250ZW50LVJhbmdlXCI6IGBieXRlcyAqLyR7Y29udGVudExlbmd0aH1gLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcy5lbmQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGVuZCA+PSBjb250ZW50TGVuZ3RoKSB7XG4gICAgICAgIGVuZCA9IGNvbnRlbnRMZW5ndGggLSAxO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhcnQgPiBlbmQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDE2KS5lbmQoKTtcbiAgICAgIH1cblxuICAgICAgc3RhdHVzQ29kZSA9IDIwNjtcbiAgICAgIGNvbnN0IGNodW5rS0IgPSAoKGVuZCAtIHN0YXJ0ICsgMSkgLyAxMDI0KS50b0ZpeGVkKDIpO1xuICAgICAgY29uc29sZS5sb2coYPCfk6YgQ2h1bms6ICR7c3RhcnR9LSR7ZW5kfSAoJHtjaHVua0tCfUtCKWApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSYW5nZSBibydsbWFzYSBoYW0ga2ljaGlrIHFpc20geXVib3Jpc2ggKHRlenJvcSBib3NobGFuaXNoKVxuICAgICAgZW5kID0gTWF0aC5taW4oT1BUSU1BTF9DSFVOS19TSVpFIC0gMSwgY29udGVudExlbmd0aCAtIDEpO1xuICAgICAgc3RhdHVzQ29kZSA9IDIwNjtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5qAIEluaXRpYWwgY2h1bms6IDAtJHtlbmR9ICgkeyhlbmQgLyAxMDI0KS50b0ZpeGVkKDIpfUtCKWApO1xuICAgIH1cblxuICAgIGNvbnN0IGNodW5rU2l6ZSA9IGVuZCAtIHN0YXJ0ICsgMTtcblxuICAgIC8vIPCfjqwgQjIgZGFuIHZpZGVvIHFpc21pbmkgb2xpc2hcbiAgICBjb25zdCB2aWRlb1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2godmlkZW9VcmwsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYjJBdXRoLmF1dGhvcml6YXRpb25Ub2tlbixcbiAgICAgICAgUmFuZ2U6IGBieXRlcz0ke3N0YXJ0fS0ke2VuZH1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghdmlkZW9SZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBCMiBzdHJlYW0gZXJyb3I6XCIsIHZpZGVvUmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIlZpZGVvIHN0cmVhbSB4YXRvc2lcIiB9KTtcbiAgICB9XG5cbiAgICAvLyDwn5qAIE9QVElNQUwgUkVTUE9OU0UgSEVBREVSU1xuICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBjb250ZW50VHlwZSxcbiAgICAgIFwiQWNjZXB0LVJhbmdlc1wiOiBcImJ5dGVzXCIsXG4gICAgICBcIkNvbnRlbnQtUmFuZ2VcIjogYGJ5dGVzICR7c3RhcnR9LSR7ZW5kfS8ke2NvbnRlbnRMZW5ndGh9YCxcbiAgICAgIFwiQ29udGVudC1MZW5ndGhcIjogY2h1bmtTaXplLFxuICAgICAgXG4gICAgICAvLyBDYWNoZSBzdHJhdGVnaXlhc2kgLSB0ZXogeXVrbGFzaCB1Y2h1blxuICAgICAgXCJDYWNoZS1Db250cm9sXCI6IFwicHVibGljLCBtYXgtYWdlPTMxNTM2MDAwLCBpbW11dGFibGVcIixcbiAgICAgIFwiRVRhZ1wiOiBgXCIke2NvbnRlbnRMZW5ndGh9LSR7c3RhcnR9LSR7ZW5kfVwiYCxcbiAgICAgIFxuICAgICAgLy8gQ29ubmVjdGlvbiBvcHRpbWl6YXRzaXlhc2lcbiAgICAgIFwiQ29ubmVjdGlvblwiOiBcImtlZXAtYWxpdmVcIixcbiAgICAgIFwiS2VlcC1BbGl2ZVwiOiBcInRpbWVvdXQ9NSwgbWF4PTEwMFwiLFxuICAgICAgXG4gICAgICAvLyBDb21wcmVzc2lvbiAoYWdhciBrZXJhayBibydsc2EpXG4gICAgICBcIlZhcnlcIjogXCJBY2NlcHQtRW5jb2RpbmdcIixcbiAgICB9O1xuXG4gICAgcmVzLndyaXRlSGVhZChzdGF0dXNDb2RlLCBoZWFkZXJzKTtcblxuICAgIC8vIPCfk7ogU1RSRUFNIFFJTElTSCAtIGJhY2twcmVzc3VyZSBiaWxhblxuICAgIGlmICh2aWRlb1Jlc3BvbnNlLmJvZHkpIHtcbiAgICAgIGxldCBieXRlc1N0cmVhbWVkID0gMDtcbiAgICAgIGNvbnN0IHJlYWRlciA9IHZpZGVvUmVzcG9uc2UuYm9keTtcbiAgICAgIFxuICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiByZWFkZXIpIHtcbiAgICAgICAgYnl0ZXNTdHJlYW1lZCArPSBjaHVuay5sZW5ndGg7XG4gICAgICAgIFxuICAgICAgICAvLyBCYWNrcHJlc3N1cmUgaGFuZGxpbmcgLSBidWZmZXIgdG8nbHNhIGt1dGlzaFxuICAgICAgICBpZiAoIXJlcy53cml0ZShjaHVuaykpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlcy5vbmNlKCdkcmFpbicsIHJlc29sdmUpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUHJvZ3Jlc3MgbG9nIChoYXIgMTAwS0IgZGEpXG4gICAgICAgIGlmIChieXRlc1N0cmVhbWVkICUgKDEwMCAqIDEwMjQpIDwgY2h1bmsubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSAoKGJ5dGVzU3RyZWFtZWQgLyBjaHVua1NpemUpICogMTAwKS50b0ZpeGVkKDEpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDimqEgU3RyZWFtaW5nOiAke3Byb2dyZXNzfSVgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBjb25zdCBzcGVlZCA9IChieXRlc1N0cmVhbWVkIC8gMTAyNCAvIChkdXJhdGlvbiAvIDEwMDApKS50b0ZpeGVkKDIpO1xuICAgICAgY29uc29sZS5sb2coYOKchSBTdHJlYW0gY29tcGxldGU6ICR7KGJ5dGVzU3RyZWFtZWQgLyAxMDI0KS50b0ZpeGVkKDIpfUtCIGluICR7ZHVyYXRpb259bXMgKCR7c3BlZWR9S0IvcylgKTtcbiAgICB9XG5cbiAgICByZXMuZW5kKCk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFN0cmVhbSBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIGlmICghcmVzLmhlYWRlcnNTZW50KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgICAgZXJyb3I6IFwiVmlkZW8gc3RyZWFtaW5nIHhhdG9zaVwiLCBcbiAgICAgICAgZGV0YWlsczogZXJyb3IubWVzc2FnZSBcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXMuZW5kKCk7XG4gIH1cbn0iXSwibmFtZXMiOlsiZmV0Y2giLCJCMl9LRVlfSUQiLCJCMl9BUFBMSUNBVElPTl9LRVkiLCJPUFRJTUFMX0NIVU5LX1NJWkUiLCJNQVhfQ0hVTktfU0laRSIsImNhY2hlZEF1dGgiLCJhdXRoRXhwaXJ5IiwiYXV0aGVudGljYXRlQjIiLCJub3ciLCJEYXRlIiwiY29uc29sZSIsImxvZyIsImF1dGgiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJyZXNwb25zZSIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwib2siLCJlcnJvclRleHQiLCJ0ZXh0IiwiZXJyb3IiLCJFcnJvciIsImF1dGhEYXRhIiwianNvbiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzdGFydFRpbWUiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJlbmQiLCJ2aWRlb1VybCIsInF1ZXJ5IiwiZmlsZU5hbWUiLCJzdWJzdHJpbmciLCJzdGFydHNXaXRoIiwiYjJBdXRoIiwiaGVhZFJlc3BvbnNlIiwiYXV0aG9yaXphdGlvblRva2VuIiwiY29udGVudExlbmd0aCIsInBhcnNlSW50IiwiZ2V0IiwiY29udGVudFR5cGUiLCJ0b0ZpeGVkIiwid3JpdGVIZWFkIiwicmFuZ2UiLCJzdGFydCIsInN0YXR1c0NvZGUiLCJwYXJ0cyIsInJlcGxhY2UiLCJzcGxpdCIsIk1hdGgiLCJtaW4iLCJjaHVua0tCIiwiY2h1bmtTaXplIiwidmlkZW9SZXNwb25zZSIsIlJhbmdlIiwiYm9keSIsImJ5dGVzU3RyZWFtZWQiLCJyZWFkZXIiLCJjaHVuayIsImxlbmd0aCIsIndyaXRlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvbmNlIiwicHJvZ3Jlc3MiLCJkdXJhdGlvbiIsInNwZWVkIiwiaGVhZGVyc1NlbnQiLCJkZXRhaWxzIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/stream.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fstream&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fstream.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();